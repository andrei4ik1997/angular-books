import{a as z}from"./chunk-CXUO3N67.js";import{a as J,b as G,c as R,d as lt,e as st,f as mt,g as dt,h as ct,i as ht,j as q,k as $,l as pt,m as ft}from"./chunk-UC2ODF3E.js";import{A as ut,C as V,D as B,E as O,F as P,J as I,K as L,p as N,q as T,s as k,t as it,v as nt,x as at,y as rt}from"./chunk-U7ISBZH6.js";import"./chunk-JGYM447R.js";import{ha as ot,o as tt,v as et,ya as b}from"./chunk-BRQE4MZL.js";import"./chunk-EIGY46AT.js";import{j as Z}from"./chunk-PK5D3EGC.js";import{Bb as c,Ca as v,Da as w,Gb as _,Ib as U,Jb as W,Kb as r,La as F,Lb as a,Ma as D,Mb as g,Ob as S,Qb as m,Rb as h,Zb as l,_b as X,bc as C,dc as j,ec as H,gb as s,ma as d,qa as x,ra as p,tb as Q,uc as Y,zb as f}from"./chunk-5G7GW4F7.js";import{a as E,b as y}from"./chunk-55KE2TB7.js";function vt(t,e){t&1&&(r(0,"mat-hint",3),l(1,"\u0410\u0432\u0442\u043E\u0440 \u0443\u0436\u0435 \u0434\u043E\u0431\u0430\u0432\u043B\u0435\u043D"),a())}var _t=(()=>{let e=class e{constructor(){this.matDialogRef=d(lt),this.matDialogData=d(st),this.formBuilder=d(V),this.authorFormGroup=this.formBuilder.nonNullable.group({name:this.formBuilder.nonNullable.control("",[T.required,b(this.matDialogData.authors??[],"name")])})}close(){this.matDialogRef.close()}add(){let i=this.authorFormGroup.getRawValue(),o=y(E({},i),{id:new Date().getTime()});this.matDialogRef.close(o)}};e.\u0275fac=function(o){return new(o||e)},e.\u0275cmp=p({type:e,selectors:[["add-new-author"]],standalone:!0,features:[C],decls:14,vars:3,consts:[["mat-dialog-title",""],[1,"form",3,"formGroup"],["matInput","","formControlName","name"],["align","start"],["mat-button","",3,"click"],["mat-button","","mat-flat-button","","color","primary",3,"click","disabled"]],template:function(o,n){o&1&&(r(0,"h2",0),l(1,"\u0414\u043E\u0431\u0430\u0432\u043B\u0435\u043D\u0438\u0435 \u043D\u043E\u0432\u043E\u0433\u043E \u0430\u0432\u0442\u043E\u0440\u0430"),a(),r(2,"mat-dialog-content")(3,"form",1)(4,"mat-form-field")(5,"mat-label"),l(6,"\u0410\u0432\u0442\u043E\u0440"),a(),g(7,"input",2),f(8,vt,2,0,"mat-hint",3),a()()(),r(9,"mat-dialog-actions")(10,"button",4),m("click",function(){return n.close()}),l(11,"\u041E\u0442\u043C\u0435\u043D\u0438\u0442\u044C"),a(),r(12,"button",5),m("click",function(){return n.add()}),l(13," \u0414\u043E\u0431\u0430\u0432\u0438\u0442\u044C "),a()()),o&2&&(s(3),c("formGroup",n.authorFormGroup),s(5),_(8,n.authorFormGroup.controls.name.getError("valueExist")?8:-1),s(4),c("disabled",n.authorFormGroup.invalid))},dependencies:[L,I,O,P,$,q,R,G,dt,ct,ht,B,nt,N,k,it,rt,ut],styles:["[_nghost-%COMP%]{--mat-dialog-actions-alignment: flex-end}[_nghost-%COMP%]   .mat-mdc-dialog-content[_ngcontent-%COMP%]   .mat-mdc-form-field[_ngcontent-%COMP%]{width:100%}"],changeDetection:0});let t=e;return t})();function wt(t,e){t&1&&(r(0,"mat-hint",2),l(1,"\u0410\u0432\u0442\u043E\u0440 \u0443\u0436\u0435 \u0434\u043E\u0431\u0430\u0432\u043B\u0435\u043D"),a())}function Ft(t,e){if(t&1){let u=S();r(0,"mat-form-field")(1,"mat-label"),l(2,"\u0410\u0432\u0442\u043E\u0440"),a(),g(3,"input",1),f(4,wt,2,0,"mat-hint",2),a(),r(5,"mat-icon",3),m("click",function(){v(u);let o=h();return w(o.changeEditMode(!1))}),l(6,"done"),a()}if(t&2){let u=h();s(3),c("formControl",u.authorNameFormControl),s(),_(4,u.authorNameFormControl.getError("valueExist")?4:-1)}}function St(t,e){if(t&1){let u=S();r(0,"span"),l(1),a(),r(2,"mat-icon",3),m("click",function(){v(u);let o=h();return w(o.changeEditMode(!0))}),l(3,"edit"),a()}if(t&2){let u=h();s(),X(u.author().name)}}var gt=(()=>{let e=class e{constructor(){this.formBuilder=d(V),this.author=D.required(),this.authors=D.required(),this.editAuthor=F(),this.isEditMode=Q(!1),this.authorNameFormControl=this.formBuilder.nonNullable.control("",[T.required]),Y(()=>{this.authorNameFormControl.addValidators(b(this.authors()??[],"name"))})}changeEditMode(i){if(!i&&this.authorNameFormControl.valid){let o=y(E({},this.author()),{name:this.authorNameFormControl.value});this.editAuthor.emit(o)}this.isEditMode.set(i),this.authorNameFormControl.setValue(i?this.author().name:"",{emitEvent:!1})}};e.\u0275fac=function(o){return new(o||e)},e.\u0275cmp=p({type:e,selectors:[["author"]],inputs:{author:[x.SignalBased,"author"],authors:[x.SignalBased,"authors"]},outputs:{editAuthor:"editAuthor"},standalone:!0,features:[C],decls:3,vars:1,consts:[[1,"author"],["matInput","",3,"formControl"],["align","start"],[3,"click"]],template:function(o,n){o&1&&(r(0,"div",0),f(1,Ft,7,2)(2,St,4,1),a()),o&2&&(s(),_(1,n.isEditMode()?1:2))},dependencies:[ft,pt,$,q,I,O,P,L,B,N,k,at],styles:["[_nghost-%COMP%]{display:flex;flex-direction:column;gap:0}[_nghost-%COMP%]   .author[_ngcontent-%COMP%]{align-items:center;display:flex;gap:var(--margin-s);height:100px}"],changeDetection:0});let t=e;return t})();var Et=(t,e)=>e.id;function yt(t,e){t&1&&g(0,"spinner")}function bt(t,e){if(t&1){let u=S();r(0,"author",4),m("editAuthor",function(o){v(u);let n=h(3);return w(n.editAuthor.emit(o))}),a()}if(t&2){let u=e.$implicit,i=h(3);c("author",u)("authors",i.authors())}}function Nt(t,e){t&1&&g(0,"no-data")}function Tt(t,e){if(t&1&&U(0,bt,1,2,"author",3,Et,!1,Nt,1,0,"no-data"),t&2){let u=h(2);W(u.authors())}}function kt(t,e){t&1&&g(0,"no-data")}function Vt(t,e){if(t&1&&f(0,Tt,3,1)(1,kt,1,0),t&2){let u,i=h();_(0,(u=i.authors())!=null&&u.length?0:1)}}var Ct=(()=>{let e=class e{constructor(){this.matDialog=d(mt),this.authors=D.required(),this.authorsLoadingStatus=D.required(),this.addNewAuthor=F(),this.editAuthor=F()}openAddNewAuthorDialog(){let i={authors:this.authors()};this.matDialog.open(_t,{autoFocus:!1,width:"40vw",data:i}).afterClosed().subscribe(n=>{n&&this.addNewAuthor.emit(n)})}};e.\u0275fac=function(o){return new(o||e)},e.\u0275cmp=p({type:e,selectors:[["authors"]],inputs:{authors:[x.SignalBased,"authors"],authorsLoadingStatus:[x.SignalBased,"authorsLoadingStatus"]},outputs:{addNewAuthor:"addNewAuthor",editAuthor:"editAuthor"},standalone:!0,features:[C],decls:6,vars:2,consts:[[1,"actions"],["mat-flat-button","","color","primary",3,"click","disabled"],[1,"authors"],[1,"author",3,"author","authors"],[1,"author",3,"editAuthor","author","authors"]],template:function(o,n){if(o&1&&(r(0,"div",0)(1,"button",1),m("click",function(){return n.openAddNewAuthorDialog()}),l(2," \u0414\u043E\u0431\u0430\u0432\u0438\u0442\u044C \u0430\u0432\u0442\u043E\u0440\u0430 "),a()(),r(3,"div",2),f(4,yt,1,0,"spinner")(5,Vt,2,1),a()),o&2){let A,M;s(),c("disabled",(A=n.authorsLoadingStatus())==null?null:A.loading),s(3),_(4,(M=n.authorsLoadingStatus())!=null&&M.loading?4:5)}},dependencies:[ot,et,gt,R,G],styles:["[_nghost-%COMP%]{display:flex;flex-direction:column;gap:var(--margin);flex:1;height:0;padding:0 var(--padding-m)}[_nghost-%COMP%]   .authors[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:var(--margin-m);overflow:auto}[_nghost-%COMP%]   .authors[_ngcontent-%COMP%]::-webkit-scrollbar{height:5px;width:6px}[_nghost-%COMP%]   .authors[_ngcontent-%COMP%]::-webkit-scrollbar-track{background-color:transparent;border-radius:10px;opacity:.6;width:16px}[_nghost-%COMP%]   .authors[_ngcontent-%COMP%]::-webkit-scrollbar-thumb{background-color:#aaa;border-radius:6px}[_nghost-%COMP%]   .authors[_ngcontent-%COMP%]   .author[_ngcontent-%COMP%]:hover{box-shadow:0 0 11px #21212133}"],changeDetection:0});let t=e;return t})();var Me=(()=>{let e=class e{constructor(){this.store=d(tt),this.authors$=this.store.select(J.authors.data),this.authorsLoadingStatus$=this.store.select(J.authors.loadingStatus)}addNewAuthor(i){this.store.dispatch(z.addAuthor.requested({payload:i}))}editAuthor(i){this.store.dispatch(z.editAuthor.requested({payload:i}))}};e.\u0275fac=function(o){return new(o||e)},e.\u0275cmp=p({type:e,selectors:[["authors-container"]],standalone:!0,features:[C],decls:3,vars:6,consts:[[3,"addNewAuthor","editAuthor","authors","authorsLoadingStatus"]],template:function(o,n){o&1&&(r(0,"authors",0),j(1,"async"),j(2,"async"),m("addNewAuthor",function(M){return n.addNewAuthor(M)})("editAuthor",function(M){return n.editAuthor(M)}),a()),o&2&&c("authors",H(1,2,n.authors$))("authorsLoadingStatus",H(2,4,n.authorsLoadingStatus$))},dependencies:[Ct,Z],encapsulation:2,changeDetection:0});let t=e;return t})();export{Me as default};
